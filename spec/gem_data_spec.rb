require 'spec_helper'

describe GemData do
  before do
    Timecop.travel(Time.local(2013, 10, 7, 0, 0, 0))
    Timecop.freeze
 end

  it "collects version info for a given gem" do
    VCR.use_cassette('gem-data-haml-i18n-extractor-0.0.17-versions') do
      GemData.new("haml-i18n-extractor").versions.should include "0.0.17"
    end
  end

  it "maps built_at and versions for access" do
    VCR.use_cassette('gem-data-haml-i18n-extractor-0.0.17-versions-built-at') do
      GemData.new("haml-i18n-extractor").versions_built_at["0.0.17"].should == "2013-06-16T00:00:00Z"
    end
  end

  it "can show download information" do
    VCR.use_cassette('gem-data-haml-i18n-extractor-0.0.17-downloads-day') do
      GemData.new("haml-i18n-extractor").downloads_day("0.0.17").should == [["2013-07-11", 3], ["2013-07-12", 5], ["2013-07-13", 6], ["2013-07-14", 6], ["2013-07-15", 8], ["2013-07-16", 10], ["2013-07-17", 16], ["2013-07-18", 16], ["2013-07-19", 19], ["2013-07-20", 20], ["2013-07-21", 20], ["2013-07-22", 22], ["2013-07-23", 23], ["2013-07-24", 29], ["2013-07-25", 29], ["2013-07-26", 29], ["2013-07-27", 29], ["2013-07-28", 29], ["2013-07-29", 30], ["2013-07-30", 32], ["2013-07-31", 34], ["2013-08-01", 34], ["2013-08-02", 34], ["2013-08-03", 34], ["2013-08-04", 34], ["2013-08-05", 36], ["2013-08-06", 36], ["2013-08-07", 36], ["2013-08-08", 39], ["2013-08-09", 39], ["2013-08-10", 39], ["2013-08-11", 39], ["2013-08-12", 40], ["2013-08-13", 42], ["2013-08-14", 43], ["2013-08-15", 45], ["2013-08-16", 45], ["2013-08-17", 46], ["2013-08-18", 46], ["2013-08-19", 46], ["2013-08-20", 46], ["2013-08-21", 47], ["2013-08-22", 49], ["2013-08-23", 53], ["2013-08-24", 53], ["2013-08-25", 54], ["2013-08-26", 54], ["2013-08-27", 56], ["2013-08-28", 56], ["2013-08-29", 58], ["2013-08-30", 58], ["2013-08-31", 58], ["2013-09-01", 60], ["2013-09-02", 62], ["2013-09-03", 63], ["2013-09-04", 63], ["2013-09-05", 65], ["2013-09-06", 67], ["2013-09-07", 67], ["2013-09-08", 67], ["2013-09-09", 68], ["2013-09-10", 68], ["2013-09-11", 68], ["2013-09-12", 73], ["2013-09-13", 73], ["2013-09-14", 73], ["2013-09-15", 73], ["2013-09-16", 74], ["2013-09-17", 74], ["2013-09-18", 74], ["2013-09-19", 75], ["2013-09-20", 76], ["2013-09-21", 76], ["2013-09-22", 76], ["2013-09-23", 76], ["2013-09-24", 79], ["2013-09-25", 83], ["2013-09-26", 90], ["2013-09-27", 90], ["2013-09-28", 90], ["2013-09-29", 92], ["2013-09-30", 92], ["2013-10-01", 92], ["2013-10-02", 92], ["2013-10-03", 92], ["2013-10-04", 94], ["2013-10-05", 94], ["2013-10-06", 94], ["2013-10-07", 95]]
    end
  end


end

